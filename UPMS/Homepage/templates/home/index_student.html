{% extends 'base.html' %}
{% load static %}

{% block title %}Home{% endblock %}

{% block nav_sidebar %}
  {% include 'new_sidebar.html' with active="Homepage" %}
{% endblock %}

{% block stylesheets %}
{% include 'adminlte/lib/_styles.html' %}
  <link rel="stylesheet" href="{% static '/css/loader.css' %}">
{% endblock %}

{% block content_header %}
{% endblock %}

{% block content %}

<div class="row d-flex justify-content-center">
  <div class="col-md-12">
      <div class="card" style="background-color: #dc3545;">
        <div class="card-body">
          <div class="text-white" >
            <h1>Hello {{request.user.first_name}}!</h1>
          </div>
        </div>
      </div>
  </div>
</div>

<div class="row d-flex justify-content-center">
  <div class="col-md-10">
      <div class="card">
        <div class="card-body">
          <div class="d-flex justify-content-center">
            <h1>Student Dashboard</h1>
          </div>
        </div>
      </div>
  </div>
</div>

<div class="row d-flex justify-content-center">
  <div class="col-sm-2 mr-4">
      <div class="card">
        <div class="card-body">
          <div class="d-flex justify-content-center">
            <div col-sm-2>
              <svg width="72" height="73" viewBox="0 0 72 73" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="36" cy="36.5" r="34" stroke="#E9ECEF" stroke-width="2"/>
                <path d="M36 2.5C44.3437 2.5 52.3962 5.56812 58.6245 11.1203C64.8528 16.6725 68.8221 24.3211 69.7767 32.6101C70.7313 40.899 68.6046 49.2497 63.8014 56.0723C58.9983 62.8949 51.854 67.7132 43.7287 69.6098C35.6033 71.5065 27.0642 70.3492 19.7369 66.3581C12.4095 62.3671 6.80555 55.821 3.99173 47.966C1.1779 40.111 1.35069 31.4956 4.47722 23.7597C7.60374 16.0239 13.4657 9.70775 20.9472 6.01372" stroke="#3A57E8" stroke-width="4" stroke-linecap="round"/>
                <path d="M27.1904 44.784C26.8209 45.1944 26.854 45.8267 27.2645 46.1963C27.6749 46.5658 28.3072 46.5327 28.6767 46.1223L27.1904 44.784ZM44.7763 27.8042C44.7474 27.2527 44.2768 26.829 43.7253 26.8579L34.7376 27.3289C34.1861 27.3578 33.7624 27.8284 33.7913 28.3799C33.8202 28.9314 34.2908 29.3551 34.8423 29.3262L42.8313 28.9075L43.25 36.8965C43.2789 37.4481 43.7495 37.8717 44.301 37.8428C44.8525 37.8139 45.2762 37.3434 45.2473 36.7919L44.7763 27.8042ZM28.6767 46.1223L44.5208 28.5257L43.0345 27.1874L27.1904 44.784L28.6767 46.1223Z" fill="#ADB5BD"/>
              </svg>                                                        
            </div>
            <div col-sm-2>
              <h6 class="text-right" style="color: #8A92A6;">Total Departments</h6>
              <h3 class="text-right">{{departments.count}}</h3>
            </div>
          </div>
        </div>
      </div>
  </div>

  <div class="col-sm-2 mr-4">
    <div class="card">
      <div class="card-body">
        <div class="d-flex justify-content-center">
          <div col-sm-2>
            <svg width="72" height="73" viewBox="0 0 72 73" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="36" cy="36.5" r="34" stroke="#E9ECEF" stroke-width="2"/>
              <path d="M36 2.5C44.3437 2.5 52.3962 5.56812 58.6245 11.1203C64.8528 16.6725 68.8221 24.3211 69.7767 32.6101C70.7313 40.899 68.6046 49.2497 63.8014 56.0723C58.9983 62.8949 51.854 67.7132 43.7287 69.6098C35.6033 71.5065 27.0642 70.3492 19.7369 66.3581C12.4095 62.3671 6.80555 55.821 3.99173 47.966C1.1779 40.111 1.35069 31.4956 4.47722 23.7597" stroke="#08B1BA" stroke-width="4" stroke-linecap="round"/>
              <path d="M27.1904 44.784C26.8209 45.1944 26.854 45.8267 27.2645 46.1963C27.6749 46.5658 28.3072 46.5327 28.6767 46.1223L27.1904 44.784ZM44.7763 27.8042C44.7474 27.2527 44.2768 26.829 43.7253 26.8579L34.7376 27.3289C34.1861 27.3578 33.7624 27.8284 33.7913 28.3799C33.8202 28.9314 34.2908 29.3551 34.8423 29.3262L42.8313 28.9075L43.25 36.8965C43.2789 37.4481 43.7495 37.8717 44.301 37.8428C44.8525 37.8139 45.2762 37.3434 45.2473 36.7919L44.7763 27.8042ZM28.6767 46.1223L44.5208 28.5257L43.0345 27.1874L27.1904 44.784L28.6767 46.1223Z" fill="#ADB5BD"/>
            </svg>           
          </div>
          <div col-sm-2>
            <h6 class="text-right" style="color: #8A92A6;">Total Students</h6>
            <h3 class="text-right">{{students.count}}</h3>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-sm-2 mr-4">
    <div class="card">
      <div class="card-body">
        <div class="d-flex justify-content-center">
          <div col-sm-2>
            <svg width="71" height="73" viewBox="0 0 71 73" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="35" cy="36.5" r="34" stroke="#E9ECEF" stroke-width="2"/>
              <path d="M34.9999 2.5C43.3437 2.5 51.3962 5.56812 57.6245 11.1203C63.8528 16.6725 67.822 24.3211 68.7766 32.6101C69.7312 40.899 67.6045 49.2497 62.8014 56.0723C57.9982 62.8949 50.854 67.7132 42.7286 69.6098C34.6033 71.5065 26.0642 70.3492 18.7369 66.3581C11.4095 62.3671 5.80553 55.821 2.9917 47.966" stroke="#3A57E8" stroke-width="4" stroke-linecap="round"/>
              <path d="M26.1904 44.784C25.8209 45.1944 25.854 45.8267 26.2645 46.1963C26.6749 46.5658 27.3072 46.5327 27.6767 46.1223L26.1904 44.784ZM43.7763 27.8042C43.7474 27.2527 43.2768 26.829 42.7253 26.8579L33.7376 27.3289C33.1861 27.3578 32.7624 27.8284 32.7913 28.3799C32.8202 28.9314 33.2908 29.3551 33.8423 29.3262L41.8313 28.9075L42.25 36.8965C42.2789 37.4481 42.7495 37.8717 43.301 37.8428C43.8525 37.8139 44.2762 37.3434 44.2473 36.7919L43.7763 27.8042ZM27.6767 46.1223L43.5208 28.5257L42.0345 27.1874L26.1904 44.784L27.6767 46.1223Z" fill="#ADB5BD"/>
            </svg>                                    
          </div>
          <div col-sm-2>
            <h6 class="text-right" style="color: #8A92A6;">Total Companies</h6>
            <h3 class="text-right">{{companies.count}}</h3>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-sm-2 mr-4">
    <div class="card">
      <div class="card-body">
        <div class="d-flex justify-content-center">
          <div col-sm-2>
            <svg width="71" height="73" viewBox="0 0 71 73" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="35" cy="36.5" r="34" stroke="#E9ECEF" stroke-width="2"/>
              <path d="M34.9999 2.5C43.3437 2.5 51.3961 5.56812 57.6244 11.1203C63.8527 16.6725 67.822 24.3211 68.7766 32.6101C69.7312 40.899 67.6045 49.2497 62.8013 56.0723C57.9982 62.8949 50.854 67.7132 42.7286 69.6098C34.6033 71.5065 26.0642 70.3492 18.7368 66.3581" stroke="#08B1BA" stroke-width="4" stroke-linecap="round"/>
              <path d="M26.1904 44.784C25.8209 45.1944 25.854 45.8267 26.2645 46.1963C26.6749 46.5658 27.3072 46.5327 27.6767 46.1223L26.1904 44.784ZM43.7763 27.8042C43.7474 27.2527 43.2768 26.829 42.7253 26.8579L33.7376 27.3289C33.1861 27.3578 32.7624 27.8284 32.7913 28.3799C32.8202 28.9314 33.2908 29.3551 33.8423 29.3262L41.8313 28.9075L42.25 36.8965C42.2789 37.4481 42.7495 37.8717 43.301 37.8428C43.8525 37.8139 44.2762 37.3434 44.2473 36.7919L43.7763 27.8042ZM27.6767 46.1223L43.5208 28.5257L42.0345 27.1874L26.1904 44.784L27.6767 46.1223Z" fill="#ADB5BD"/>
            </svg>                                     
          </div>
          <div col-sm-2>
            <h6 class="text-right" style="color: #8A92A6;">Placed Students</h6>
            <h3 class="text-right">{{placed_students.count}}</h3>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-sm-2 mr-4">
    <div class="card">
      <div class="card-body">
        <div class="d-flex justify-content-center">
          <div col-sm-2>
            <svg width="71" height="72" viewBox="0 0 71 72" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="35" cy="36.5" r="34" stroke="#E9ECEF" stroke-width="2"/>
              <path d="M35 2.5C43.3438 2.5 51.3962 5.56812 57.6245 11.1203C63.8529 16.6725 67.8221 24.3211 68.7767 32.6101C69.7313 40.899 67.6046 49.2497 62.8015 56.0723C57.9983 62.8949 50.8541 67.7132 42.7287 69.6098" stroke="#3A57E8" stroke-width="4" stroke-linecap="round"/>
              <path d="M26.1904 44.784C25.8209 45.1944 25.854 45.8267 26.2645 46.1963C26.6749 46.5658 27.3072 46.5327 27.6767 46.1223L26.1904 44.784ZM43.7763 27.8042C43.7474 27.2527 43.2768 26.829 42.7253 26.8579L33.7376 27.3289C33.1861 27.3578 32.7624 27.8284 32.7913 28.3799C32.8202 28.9314 33.2908 29.3551 33.8423 29.3262L41.8313 28.9075L42.25 36.8965C42.2789 37.4481 42.7495 37.8717 43.301 37.8428C43.8525 37.8139 44.2762 37.3434 44.2473 36.7919L43.7763 27.8042ZM27.6767 46.1223L43.5208 28.5257L42.0345 27.1874L26.1904 44.784L27.6767 46.1223Z" fill="#ADB5BD"/>
            </svg>                                  
          </div>
          <div col-sm-2>
            <h6 class="text-right" style="color: #8A92A6;">Job Offers</h6>
            <h3 class="text-right">{{offer_letters.count}}</h3>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row d-flex">

  <!-- Announcements -->
  <div class="col-md-7">
    <div class="card">
      <div class="card-header">
        <h3 class="text-center">Announcements</h3>
      </div>
      <div class="card-body" style="height: 425px; overflow-y: scroll;">
        {% for i in announcements %}
          <div>
            <b style="font-size: 18px">{{i.title}}</b>
            <a class="float-right">{{i.created_on}}</a>
            <br>
            <h7>{{i.description}}</h7>
            {% if not forloop.last %} <hr> {% endif %}
          </div>
        {% endfor %}        
      </div>
    </div>
  </div>


  <!-- Placed/Unplaced -->
  <div class="col-md-5">
    <div class="card">
      <div class="card-header">
        <h3 class="text-center">Placed / Unplaced</h3>
      </div>
      <div class="card-body py-5">
        <canvas id="myChartBar"></canvas>        
      </div>
    </div>
  </div>

  <div class="col-md-8">
    <div class="card">
      <div class="card-header">
        <h3 class="text-center">PLACED / UNPLACED</h3>
      </div>
      <div class="card-body"  >
        <canvas id="myChartline"></canvas>
      </div>
    </div>
  </div>
  
  
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>

<script>
  var endpoint = '/api/';

  $.ajax({
    method: "GET",
    url: endpoint,
    success: function(data) {
      drawLineGraph(data, 'myChartline');
    },
    error: function(error_data) {
      console.log(error_data);
    }
  })

  $.ajax({
    method: "GET",
    url: '/api/PlacedUnplaced/',
    success: function(data) {
      drawBarGraph(data, 'myChartBar');
    },
    error: function(error_data) {
      console.log(error_data);
    }
  })

  function drawLineGraph(data, id) {
    var labels = data.labels;
    var chartLabel = data.chartLabel;
    var chartdata = data.chartdata;
    var ctx = document.getElementById(id).getContext('2d');
    var chart = new Chart(ctx, {
      // The type of chart we want to create
      type: 'line',

      // The data for our dataset
      data: {
        labels: labels,
        datasets: [{
          label: chartLabel,
          backgroundColor: 'rgb(255, 100, 200)',
          borderColor: 'rgb(55, 99, 132)',
          data: chartdata,
        }]
      },

      // Configuration options go here
      options: {
        scales: {
          xAxes: [{
            display: true
          }],
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        }
      }

    });
  }

  function drawBarGraph(data, id) {
    var labels = data.labels;
    var chartLabel = data.chartLabel;
    var chartdata = data.chartdata;
    var ctx = document.getElementById(id).getContext('2d');
    var myChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: labels,
        datasets: [{
          label: chartLabel,
          data: chartdata,
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)',
            'rgba(75, 192, 192, 0.2)',
            'rgba(153, 102, 255, 0.2)',
            'rgba(255, 159, 64, 0.2)'
          ],
          borderColor: [
            'rgba(255, 99, 132, 1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)',
            'rgba(75, 192, 192, 1)',
            'rgba(153, 102, 255, 1)',
            'rgba(255, 159, 64, 1)'
          ],
          borderWidth: 1
        }]
      },
      options: {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        }
      }
    });
  }

</script>

{% endblock %}
